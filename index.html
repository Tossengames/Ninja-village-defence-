<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Shadow Rogue: Ninja Stealth</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <canvas id="game"></canvas>

    <div id="mainMenu" class="overlay">
        <h1>SHADOW ROGUE</h1>
        <div class="menu-card">
            <h3>Mission Setup</h3>
            <div class="setting-row">
                <span>Map Size:</span>
                <div class="picker">
                    <button onclick="changeMapSize(-1)">-</button>
                    <span id="mapSizeValue">12</span>
                    <button onclick="changeMapSize(1)">+</button>
                </div>
            </div>
            <div class="setting-row">
                <span>Guards:</span>
                <div class="picker">
                    <button onclick="changeGuardCount(-1)">-</button>
                    <span id="guardCountValue">5</span>
                    <button onclick="changeGuardCount(1)">+</button>
                </div>
            </div>
            <button class="primary-btn" onclick="showItemSelection()">Select Equipment</button>
            <button class="secondary-btn" onclick="showTutorial()">How to Play</button>
        </div>
    </div>

    <div id="itemSelection" class="overlay hidden">
        <h2>Equip Ninja Tools</h2>
        <p class="limit-info">Max 3 Types | Max 5 Total</p>
        
        <div id="selectedPreview" class="preview-container">
            <div class="empty-preview">Select up to 3 types / 5 total</div>
        </div>

        <div class="item-grid">
            <div class="item-card" onclick="toggleItem('trap')">
                <div class="icon">ğŸª¤</div>
                <span>Trap</span>
                <span id="trapSelCount" class="count-badge">0</span>
            </div>
            <div class="item-card" onclick="toggleItem('rice')">
                <div class="icon">ğŸš</div>
                <span>Rice</span>
                <span id="riceSelCount" class="count-badge">0</span>
            </div>
            <div class="item-card" onclick="toggleItem('bomb')">
                <div class="icon">ğŸ’£</div>
                <span>Bomb</span>
                <span id="bombSelCount" class="count-badge">0</span>
            </div>
            <div class="item-card" onclick="toggleItem('gas')">
                <div class="icon">ğŸ’¨</div>
                <span>Gas</span>
                <span id="gasSelCount" class="count-badge">0</span>
            </div>
        </div>

        <div class="stats-bar">
            Total: <span id="totalItems">0</span>/5 | Types: <span id="totalTypes">0</span>/3
        </div>

        <div class="menu-buttons">
            <button class="secondary-btn" onclick="backToMainMenu()">Back</button>
            <button class="primary-btn start-btn" onclick="startGame()">START MISSION</button>
        </div>
    </div>

    <div id="playerStatus" class="hidden">
        <div class="status-ring"></div>
        <div class="hp-bar"><div id="hpFill"></div></div>
    </div>

    <div id="ui-controls" class="hidden">
        <button onclick="toggleMinimap()">ğŸ—ºï¸</button>
        <button onclick="centerCamera()">ğŸ¯</button>
    </div>

    <div id="toolbar" class="hidden">
        <button id="btn-move" class="active" onclick="setMode('move')">ğŸš¶ Move</button>
        <button id="btn-trap" onclick="setMode('trap')">ğŸª¤ <span id="trapCount">0</span></button>
        <button id="btn-rice" onclick="setMode('rice')">ğŸš <span id="riceCount">0</span></button>
        <button id="btn-bomb" onclick="setMode('bomb')">ğŸ’£ <span id="bombCount">0</span></button>
        <button id="btn-gas" onclick="setMode('gas')">ğŸ’¨ <span id="gasCount">0</span></button>
        <button onclick="endTurn()">âŒ› Wait</button>
    </div>

    <div id="tutorialScreen" class="overlay hidden">
        <h2>Mission Intel</h2>
        <ul>
            <li>Stay out of red vision cones.</li>
            <li>Hide in purple tiles to remain invisible.</li>
            <li>Attack guards from behind for instant kills.</li>
            <li>Reach the golden Gate to escape.</li>
        </ul>
        <button class="primary-btn" onclick="hideTutorial()">Understood</button>
    </div>

    <div id="resultScreen" class="overlay hidden">
        <h1 id="resultTitle">Mission Success</h1>
        <div id="finalStats"></div>
        <button class="primary-btn" onclick="location.reload()">Return to Hub</button>
    </div>

    <div id="gameOverScreen" class="overlay hidden">
        <h1>CAUGHT</h1>
        <p>You have been eliminated.</p>
        <button class="primary-btn" onclick="location.reload()">Retry</button>
    </div>

    <script src="Core_main.js"></script>
</body>
</html>
